# 开发文档

## 软件设置

软件的初始设置位于 `Data\default.json`，此位置不可更改。

在该文件中，可以定义数据库位置等其它默认的基础参数。

## 数据库

数据库采用 `LiteDb` 数据库。本项目中有两个库。分别是用户登陆的全局数据库以及用户名下的具体数据库。

### 全局数据库

全局数据库只有一个，即用户账户库，它位于：`Data\data.db`，用户库中，不仅记录了用户数据，也记录了用户的界面状态。

### 用户组数据库

本数据库中主要有以下集合。

- 发件人

- 收件人

- 发件历史

## 用户数据目录

当用户登陆后，会在用户数据的目录中，建立 `userId` 目录，然后里面保存属于用户的数据。

- Data 目录
- Template 目录
- Image 目录

## 首页展示

- [x] 首页显示送达率
- [x] 不同邮箱类型的发件数量

## 后端服务

- [x] 所有api重构成异步

## 开发待办

### v 0.4.6 版本

- [ ] 选中组时，人员也跟着选中
- [ ] 允许有空姓名存在
- [ ] 进度条采用 websocket 方式获取
- [ ] 头像处的使用说明链接修改
- [ ] 发件过程中支持暂停、取消和继续
- [ ] 发件历史中支持单条数据的重发
- [ ] 导入邮件时，左下角的数据总数显示错误
- [ ] 模板使用过程中，模块保存提示不准确
- [ ] 模板中添加混淆代码

### v0.5.1 版本

该版本考虑付费中转服务器付费

- [ ] 支持分布式发件
- [ ] 主题可变
- [ ] 发件管道规则化，可以自定义规则

## 分布式发件

### 功能分析

1. 中心服务器

### 发件流程

1. 连接中心服务器

2. 读取邮件数据

3. 预处理模块通过中心服务器向各个终端发送发件数据

   每个分布式终端负责一个或者多个发件箱

   在发送的过程中，要做缓存处理，避免同一种数据，多次发送

4. 分布式终端使用发件模块开始发送

   分布式终端有可能会掉线、被另一端的用户禁止中继等



